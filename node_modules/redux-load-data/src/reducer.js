import Immutable from 'immutable';
import { handleActions } from 'redux-actions';

export default (
  dataRequest = 'DATA_REQUEST',
  dataResponse = 'DATA_RESPONSE',
  dataError = 'DATA_ERROR',
  dataClear = 'DATA_CLEAR',
) =>
  handleActions(
    {
      [dataRequest]: (state, { payload }) =>
        state.mergeIn(payload.keyPath, {
          error: false,
          loading: true,
        }),

      [dataResponse]: (state, { payload }) =>
        state.mergeIn(payload.keyPath, {
          error: false,
          loading: false,
          ...payload.response,
        }),

      [dataError]: (state, { payload }) =>
        state.mergeIn(payload.keyPath, {
          error: true,
          loading: false,
          ...payload.response,
        }),

      [dataClear]: (state, { payload }) => state.deleteIn(payload.keyPath),
    },
    new Immutable.Map(),
  );
